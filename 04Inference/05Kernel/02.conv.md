# 卷积操作原理

>数学原理部分待更
## 什么是卷积
卷积是神经网络里面的核心计算之一，它是一种特殊的线性运算。卷积神经网络（CNN）是针对图像领域任务提出的神经网络，其受猫的视觉系统启发，堆叠使用卷积层和池化层提取特征。它在 CV 领域方面的突破性进展引领了深度学习的热潮。卷积的变种丰富，计算复杂，神经网络运行时大部分时间都耗费在计算卷积，网络模型的发展在不断增加网络的深度，因此优化卷积计算就显得尤为重要。

## 卷积神经网络的数学原理
在通常形式中，卷积是对两个实变函数的一种数学运算。在泛函分析中，卷积、旋积或褶积 (Convolution) 是通过两个函数f和g生成第三个函数的一种数学运算，其本质是一种特殊的积分变换，表征函数 f 与 g 经过翻转和平移的重叠部分函数值乘积对重叠长度的积分。
<br />卷积神经网络（Convolution Neural Networks, CNN）的概念拓展自信号处理领域的卷积。信号处理的卷积定义为：
<br /><center> ![卷积计算公式](/images/img_formula2.png "卷积计算公式") </center>
可以证明，关于几乎所有的实数 x，随着 x 的不同取值，积分定义了一个新函数 ℎ(x)，称为函数 f 与 g 的卷积，记为：
<br /><center> ![卷积计算公式2](/images/img_formula3.png "卷积计算公式2") </center>
卷积计算在直觉上不易理解，其可视化后如下图所示。图中红色滑块在移动过程中与蓝色方块的积绘制成的三角图案即为卷积结果在各点上的取值：
<br /><center> ![卷积动图](/images/conv.gif "卷积动图") </center>

<br />对于信号处理的卷积定义为连续的表示，真正计算的过程中会把连续用离散形式进行计算：
<br /><center> ![卷积计算公式3](/images/img_formula4.png "卷积计算公式3") </center>
将该离散卷积公式拓展到二维空间即可得到神经网络中的卷积，可简写为：
<br /><center> ![卷积计算公式4](/images/img_formula5.png "卷积计算公式4") </center>
>其中：
 S为卷积的输出； I为卷积输入； K为卷积核的尺寸；

## 卷积神经网络中的卷积计算
如图1所示, 神经网络中的卷积计算过程可描述为：3 * 3 的卷积核在 8 * 8 的图像上进行滑动，每次滑动时，都把卷积核和对应位置的元素进行相乘再求和。青色区域为其感受野。
<br />
<br /> <center> ![卷积图](/images/img_2.png "卷积示意图") </center>
### 名词解释：
>填充（padding）：防止图像边缘信息丢失，在输入图像的周围添加额外的行/列。其作用为使卷积后图像分辨率不变，方便计算特征图尺寸的变化，弥补边界

>卷积核：是具有可学习参数的算子，用于对输出图像进行特征提取，输出通常为特征图。每一个卷积核代表一种模式/特征，有几个卷积核就有几张特征图,每一个卷积核都对应一个特征图。在机器学习中，卷积核的参数是由反向传播/梯度下降算法计算更新，非人工设置。其特点为：
><br />    1）卷积核每次仅连接K*K区域，K*K是卷积核的尺寸；
><br />    2）卷积核参数重复使用（参数共享），在图像上滑动。

>特征图：输出特征图的尺寸的计算公式为如下所示。 
> <br /><center> ![特征图计算公式](/images/img_formula1.png "特征图计算公式") </center>

>卷积层：用来提取图像的底层特征
><br />  池化层：使用1个像素表示一块区域的像素值（均值或最值），降低图像分辨率，用来防止过拟合，减少参数量
><br />  全连接层：用来汇总特征信息，进行输出

在常见的RGB图像三通道(Channel)卷积计算中，如图2所示：
<br /> <center> ![特征图计算公式](/images/img_3.png "特征图计算公式") </center>

<br /> 其过程可描述为：红色的卷积核层和红色通道的层进行卷积，绿色的卷积核层和绿色通道的层进行卷积，蓝色同上。之后三个通道的计算结果加起来作为最后的输出结果。
该动画源于：[RGB三通道卷积](https://thomelane.github.io/convolutions/2DConvRGB.html "RGB三通道卷积")

### 卷积网络的过程（以LeNet手写数字识别为例）：
<br /><center> ![LeNet手写数字识别](/images/img_4.png "LeNet手写数字识别") </center>

第一步把手写数字图片转成灰度图像。之后通过6个卷积核对灰度图进行卷积计算，生成6张特征图。之后通过6个卷积核对上述特征图进行下采样，即池化操作。之后再经16个卷积核对池化结果再次进行卷积，得到16张特征图，再通过16个卷积核对前述特征图进行下采样，之后把得到的结果拉平成一个长向量，送入全连接层（2层），最终输出到softmax层，得到识别结果。
## 卷积的优化手段（待完成）

## 参考文献

## 本节视频

<html>
<iframe src="https:&as_wide=1&high_quality=1&danmaku=0&t=30&autoplay=0" width="100%" height="500" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe>
</html>

