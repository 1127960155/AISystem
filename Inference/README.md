# 推理引擎

训练过程通过设定数据处理方式，并设计合适的网络模型结构以及损失函数和优化算法，在此基础上将数据集以小批量（mini-batch）反复进行前向计算并计算损失，然后反向计算梯度利用特定的优化函数来更新模型，来使得损失函数达到最优的结果。训练过程最重要的就是梯度的计算和反向传播。

而推理就是在训练好的模型结构和参数基础上，做一次前向传播得到模型输出的过程。相对于训练而言，推理不涉及梯度和损失优化。推理的最终目标是将训练好的模型部署生产环境中。真正让 AI 能够运用起来。推理引擎可以将深度学习模型部署到云（Cloud）端或者边缘（Edge）端，并服务用户的请求。模型训练过程好比是传统软件工程中的代码开发的过程，而开发完的代码势必要打包，部署给用户使用，那么推理系统就负责应对模型部署的生命周期中遇到的挑战和问题。

当推理系统将完成训练的模型进行部署，并在服务时还需要考虑设计和提供负载均衡，请求调度，加速优化，多副本和生命周期管理等支持。相比深度学习框架等为训练而设计的系统，推理系统不仅关注低延迟，高吞吐，可靠性等设计目标，同时受到资源，服务等级协议（Service-Level Agreement），功耗等约束。本章将围绕深度学习推理系统的设计，实现与优化内容展开，同时还会在最后介绍部署和 MLOps 等内容。

移动端的推理引擎应该挺多的了，google在2017年推出了TF-Lite，腾讯在2017年推出了ncnn，Apple在2017也推出了CoreML，阿里在2018年推出了MNN，华为2019年推出了MindSpsore-Lite。距今已经过去了快5年的时间，技术上也接近收敛。下面让我们一起打开推理引擎的技术吧！

## 课程部分

|     |       |              |                                                                                                 |     |
| --- | ----- | ------------ | ----------------------------------------------------------------------------------------------- | --- |
| 编号  | 名称    | 内容           | 资源                                                                                              | 备注  |
| 1   | 推理系统  | 01 内容介绍      | [slide](./Inference/01.introduction.pdf), [video](https://www.bilibili.com/video/BV1J8411K7pj/) |     |
|     | 推理系统  | 02 什么是推理系统   | [slide](./Inference/02.constraints.pdf), [video](https://www.bilibili.com/video/BV1nY4y1f7G5/)  |     |
|     | 推理系统  | 03 推理流程全景    | [slide](./Inference/03.workflow.pdf), [video]()                                                 |     |
|     | 推理系统  | 04 推理系统架构    | [slide](./Inference/04.system.pdf), [video]()                                                   |     |
|     | 推理系统  | 05(上) 推理引擎架构 | [slide](./Inference/05.inference.pdf), [video]()                                                |     |
|     | 推理系统  | 05(下) 推理引擎架构 | [slide](./Inference/06.architecture.pdf), [video]()                                             |     |
|     |       |              |                                                                                                 |     |
| 2   | 离线优化  | 低比特量化        | slide, video                                                                                    |     |
|     | 离线优化  | 二值化网络        | slide, video                                                                                    |     |
|     | 离线优化  | 网络剪枝         | slide, video                                                                                    |     |
|     | 离线优化  | 模型蒸馏         | slide, video                                                                                    |     |
|     |       |              |                                                                                                 |     |
| 3   | 部署优化  | 图转换与优化       | slide, video                                                                                    |     |
|     | 部署优化  |              | slide, video                                                                                    |     |
|     | 部署优化  |              | slide, video                                                                                    |     |
|     |       |              |                                                                                                 |     |
| 4   | 运行时优化 | 并发执行         | slide, video                                                                                    |     |
|     | 运行时优化 | 动态Batch      | slide, video                                                                                    |     |
|     | 运行时优化 | 内存分配         | slide, video                                                                                    |     |
|     |       |              |                                                                                                 |     |

## 项目背景

近年来人工智能特别是深度学习技术得到了飞速发展，这背后离不开计算机硬件和软件系统的不断进步。在可见的未来，人工智能技术的发展仍将依赖于计算机系统和人工智能相结合的共同创新模式。需要注意的是，计算机系统现在正以更大的规模和更高的复杂性来赋能于人工智能，这背后不仅需要更多的系统上的创新，更需要系统性的思维和方法论。与此同时，人工智能也反过来为设计复杂系统提供支持。

我们注意到，现在的大部分人工智能相关的课程，特别是深度学习和机器学习相关课程主要集中在相关理论、算法或者应用，与系统相关的课程并不多见。我们希望人工智能系统这门课能让人工智能相关教育变得更加全面和深入，以共同促进人工智能与系统在开源方面的共同学习和讨论。

（原谅我复制粘贴微软[AI-System](https://github.com/microsoft/AI-System)的介绍，人家写得很好啦；另外推荐一个很好学习参考项目，公司跟英国麦络老师（爱丁堡大学）合作的[机器学习系统：设计和实现](https://github.com/openmlsys/openmlsys-zh)。）
