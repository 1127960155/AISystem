# 死代码消除

## 死代码消除概述

编译器原理中，死代码消除(Dead code elimination,Dce) 是一种编译优化技术，它的用途是移除对程序执行结果没有任何影响的代码。移除这类的代码有两种有点，不但可以减少程序的大小，还可以避免程序在执行中进行不相关的运算行为，减少它执行的时间。

比如在主程序中，return操作后面的操作都可以认定为死代码。

死代码删除最普遍的做法，是透过预处理器来判断代码是否需要被编译，即可以透过一个数值来决定程序段是否该被编译。

死代码删除的优点：

- 避免执行不必要的操作，提高了运行的效率，减少了运行时间。
- 节省不必要的资源分配，优化空间。
- 减少代码的长度，增加可读性。

## AI编译器中的死代码消除

死代码消除可以优化计算图的计算和存储效率，避免为死节点(无用节点)分配存储和进行计算，同时简化了计算图的结构，方便进行后续的其他图优化Pass。

死代码消除一般不是在定义神经网络模型结构的时候引起的，而是其他图优化Pass造成的结果，因此死代码消除Pass常常在其他图优化Pass后被应用

AI编译器死代码消除一般过程：

- 获取逆后续节点集：对计算图Graph IR 进行深度优先遍历DFS，将结果逆转得到逆后续节点集。逆后续得到的结果就是拓扑排序，即访问到某一个节点时，该节点的依赖节点都已经被访问。

- 遍历后续节点集， 判断是否为死节点：获取节点的输出值，判断是否为计算图的输出节点；如果不是输出节点且无对应输出节点，则为死节点。

- 删除死节点，从新遍历计算图：删除死节点，值得注意的是死节点删除后需要删除对应输入的边，然后重复步骤1。

## 本节视频

<html>
<iframe src="https:&as_wide=1&high_quality=1&danmaku=0&t=30&autoplay=0" width="100%" height="500" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe>
</html>
